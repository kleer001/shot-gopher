{#
Processing Panel Component
Displays real-time processing progress and logs

Parameters:
  - panel_class: CSS class for the panel container
  - progress_type: Type of progress indicator ('bar', 'ring', 'circle', 'text')
  - show_log: Whether to show the log output (default: true)
#}
{% macro processing_panel(panel_class='', progress_type='bar', show_log=true) %}
<div id="processing-panel" class="processing-panel hidden {{ panel_class }}" role="region" aria-label="Processing status panel">
    <!-- Header -->
    <div class="panel-header">
        <h2>Processing: <span id="processing-project-name">--</span></h2>
        <button type="button" id="cancel-processing-btn" class="btn btn-danger" aria-label="Cancel processing">Cancel</button>
    </div>

    <!-- System Status -->
    <div class="system-status">
        <div id="system-status" class="status-indicator" role="status" aria-live="polite">
            <span class="status-dot" aria-hidden="true"></span>
            <span class="status-text">Checking...</span>
        </div>
    </div>

    <!-- Progress Display -->
    <div class="progress-container" role="status" aria-live="polite" aria-label="Processing progress">
        {% if progress_type == 'bar' %}
        <!-- Linear Progress Bar -->
        <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="Processing progress bar">
            <div class="progress-fill" id="processing-progress-fill"></div>
        </div>
        {% elif progress_type == 'ring' %}
        <!-- SVG Progress Ring (Dashboard style) -->
        <div class="progress-ring" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
            <svg viewBox="0 0 120 120" aria-hidden="true">
                <circle cx="60" cy="60" r="54" class="ring-bg"></circle>
                <circle cx="60" cy="60" r="54" class="ring-progress" id="progress-ring"></circle>
            </svg>
            <div class="ring-center">
                <div id="progress-percent" class="ring-percent" aria-live="polite">0%</div>
                <div id="current-stage-name" class="ring-stage" aria-live="polite">--</div>
            </div>
        </div>
        {% elif progress_type == 'circle' %}
        <!-- SVG Progress Circle (Split style) -->
        <div class="progress-circle" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
            <svg viewBox="0 0 200 200" aria-hidden="true">
                <circle cx="100" cy="100" r="90" class="circle-bg"></circle>
                <circle cx="100" cy="100" r="90" class="circle-fill" id="progress-circle"></circle>
            </svg>
            <div class="circle-content">
                <div id="progress-percent" class="circle-percent" aria-live="polite">0%</div>
                <div id="current-stage-name" class="circle-label" aria-live="polite">IDLE</div>
            </div>
        </div>
        {% else %}
        <!-- Text-based Progress (Cards style) -->
        <div class="progress-display">
            <div id="progress-percent" class="progress-big" aria-live="polite">0%</div>
            <div id="current-stage-name" class="progress-stage" aria-live="polite">IDLE</div>
        </div>
        {% endif %}

        <!-- Stage Counter -->
        <div class="stage-counter">
            <span id="current-stage-label">STAGE 1/1</span>
        </div>
    </div>

    <!-- Progress Stats -->
    <div class="progress-stats">
        <div class="stat">
            <span class="stat-label">Frames</span>
            <span id="progress-frames" class="stat-value">Frame 0 / 0</span>
        </div>
        <div class="stat">
            <span class="stat-label">Elapsed</span>
            <span id="elapsed-time" class="stat-value">0:00</span>
        </div>
        <div class="stat">
            <span class="stat-label">Remaining</span>
            <span id="remaining-time" class="stat-value">--</span>
        </div>
    </div>

    <!-- Stages List -->
    <div class="stages-section">
        <h3>Pipeline Stages</h3>
        <div id="stages-list-progress" class="stages-list">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    {% if show_log %}
    <!-- Console Log -->
    <div class="console-section" role="region" aria-label="Console output">
        <div class="console-header">
            <h3>CONSOLE</h3>
            <button type="button" id="clear-logs-btn" class="btn-clear" aria-label="Clear console logs">CLEAR</button>
        </div>
        <div id="log-output" class="log-output" role="log" aria-live="polite" aria-atomic="false"></div>
    </div>
    {% endif %}
</div>
{% endmacro %}
